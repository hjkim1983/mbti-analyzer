# 🤖 MBTI 분석 웹앱 개발 및 분석 지침 (Bkit 통합본)

## 1. 프레임워크 및 개발 원칙 (Bkit 표준)
* **표준 준수**: 이 프로젝트는 `.cursor/skills/bkit`에 정의된 규격과 라이브러리를 엄격히 따릅니다.
* **PDCA 사이클**: 모든 작업은 Plan-Design-Check-Act 사이클을 기반으로 하며, 시작 전 반드시 `/pdca plan`으로 기획을 확정합니다.
* **개발 파이프라인**: 모든 프로세스는 '9-Phase Development Pipeline' 단계에 맞춰 진행합니다.
* **품질 검증**: 코드 작성 후 Evaluator-Optimizer 패턴을 사용하여 품질을 검증합니다.

## 2. 핵심 서비스 워크플로우 (Business Logic)
모든 개발은 아래의 사용자 여정을 순차적으로 따르도록 구현합니다:
1. **데이터 입력**: 카톡 캡처 업로드, 분석 대상 이름(`targetName`), 메모(`memo`)를 입력받습니다.
2. **무료 횟수 조회 (Supabase)**: 버튼 클릭 시 DB에서 해당 사용자의 누적 분석 횟수를 조회합니다.
3. **분기 처리 (Free vs Paid)**:
   - **Case A (누적 3회 이하)**: 결제창 없이 즉시 4단계(AI 분석)로 진행합니다.
   - **Case B (누적 4회 이상)**: 포트원 결제창을 실행하며, 결제 성공(`paid`) 시에만 4단계로 진행합니다.
4. **AI 정밀 분석**: `mbti_skills.md` 지침에 따라 Gemini API를 호출하여 결과를 생성하고 DB에 저장합니다.
5. **결과 출력**: `loadingSteps` 애니메이션 종료 후 최종 보고서를 렌더링합니다.

## 3. 분석 에이전트 및 디자인 지침
* **분석 기준**: 루트의 `mbti_skills.md` 가이드라인을 최우선 순위로 준수합니다.
* **통합 이미지 처리**: AI 멀티모달 기능을 활용해 이미지 뭉치에서 대화([A])와 프로필([B])을 스스로 분류 분석합니다.
* **가중치 정의**: [A] 카톡 대화(50%), [B] 프로필(15%), [C] 메모 텍스트(35% - 가장 강력한 가중치 부여).
* **디자인**: `@kakao-mbti-scanner.jsx`의 레이아웃과 애니메이션을 유지하되, 세련된 **글래스모피즘** 스타일을 적용합니다.

## 4. 기술, 보안 및 자동화 규칙
* **기술 스택**: Next.js (App Router), Tailwind CSS, Supabase를 사용합니다.
* **보안**: 이미지는 Base64 변환 후 즉시 폐기하며 절대 서버에 저장하지 않습니다.
* **확장성**: 향후 **사주(Saju)** 기능을 위해 `profiles` 테이블에 `birth_date`, `birth_time` 컬럼을 미리 포함합니다.
* **Git 자동 커밋**: 작업 완료 후 반드시 한글 커밋 메시지로 자동 커밋합니다. (예: "결제 로직 연동 및 DB 업데이트")